<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gia ƒê√¨nh TV Launcher</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

    <style>
        /* --- C·∫§U H√åNH CHUNG --- */
        body {
            background-color: #121212;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            margin-bottom: 10px;
            font-size: 2.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #4CAF50;
            text-shadow: 2px 2px 4px #000;
        }

        .control-bar {
            width: 90%;
            max-width: 1200px;
            display: flex;
            justify-content: flex-end;
            margin-bottom: 20px;
        }

        .btn-reload {
            background-color: #333;
            color: #ccc;
            border: 2px solid #555;
            padding: 10px 25px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-reload:focus, .btn-reload:hover {
            background-color: #2196F3;
            color: white;
            transform: scale(1.1);
            border-color: white;
            box-shadow: 0 0 15px rgba(33, 150, 243, 0.8);
            outline: none;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            width: 90%;
            max-width: 1200px;
            padding-bottom: 50px;
        }

        .card {
            background-color: #1e1e1e;
            border: 2px solid #333;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            text-decoration: none;
            color: white;
            transition: all 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 150px;
            cursor: pointer;
        }

        .card-icon { font-size: 3rem; margin-bottom: 10px; }
        .card-title { font-size: 1.5rem; font-weight: bold; }

        .card:focus, .card:hover {
            transform: scale(1.05);
            background-color: #4CAF50;
            border-color: #fff;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.6);
            outline: none;
            z-index: 10;
        }

        /* --- ADMIN PANEL CSS --- */
        .admin-section {
            width: 90%;
            max-width: 800px;
            margin-top: 50px;
            padding: 20px;
            border-top: 2px dashed #444;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .admin-title {
            color: #FF5722;
            font-size: 1.5rem;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .input-group { display: flex; gap: 10px; }
        
        #classInput {
            flex: 1; padding: 15px; border-radius: 8px; border: 1px solid #555;
            background: #222; color: #fff; font-size: 1.1rem;
        }
        #classInput:focus { border-color: #FF5722; outline: none; }

        .btn-add {
            padding: 0 25px; background: #FF5722; color: white; border: none;
            border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1rem;
        }
        .btn-add:hover { background: #E64A19; }

        .tag-container {
            display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; min-height: 50px;
        }

        .tag-chip {
            background: #333; border: 1px solid #555; padding: 8px 15px;
            border-radius: 20px; font-size: 1rem; display: flex; align-items: center; gap: 10px;
        }
        .tag-name { color: #eee; font-family: monospace; }
        .tag-delete {
            background: #ff4444; color: white; width: 20px; height: 20px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            cursor: pointer; border: none; font-weight: bold;
        }
        #loading { color: #888; font-style: italic; }
    </style>
</head>
<body>

    <h1>üì∫ K√™nh Gia ƒê√¨nh</h1>

    <div class="control-bar">
        <div id="reloadBtn" class="btn-reload" tabindex="0">üîÑ T·∫£i l·∫°i trang</div>
    </div>

    <div class="grid-container" id="app"></div>

    <div class="admin-section">
        <div class="admin-title">üõ°Ô∏è Qu·∫£n l√Ω Ch·∫∑n Qu·∫£ng C√°o (Firebase)</div>
        <div class="input-group">
            <input type="text" id="classInput" placeholder="Nh·∫≠p class/id (V√≠ d·ª•: .ads-box ho·∫∑c #banner)">
            <button class="btn-add" onclick="addNewClass()">TH√äM</button>
        </div>
        <div id="loading">ƒêang k·∫øt n·ªëi Firebase...</div>
        <div class="tag-container" id="tagList"></div>
    </div>

    <script>
        // --- 1. CONFIG & INIT FIREBASE ---
        const firebaseConfig = {
            apiKey: "AIzaSyARyxrxmbNLaxSdDP14S5YQES5AJnLj-XU",
            authDomain: "mylife-ddd6a.firebaseapp.com",
            databaseURL: "https://mylife-ddd6a-default-rtdb.firebaseio.com",
            projectId: "mylife-ddd6a",
            storageBucket: "mylife-ddd6a.firebasestorage.app",
            messagingSenderId: "969759088030",
            appId: "1:969759088030:web:69155b992b0cea296e4a8f",
            measurementId: "G-V80ERR7KWQ"
        };

        // Kh·ªüi t·∫°o (Nh·ªù d√πng b·∫£n -compat n√™n l·ªánh n√†y m·ªõi ch·∫°y ƒë∆∞·ª£c)
        try {
            firebase.initializeApp(firebaseConfig);
            const db = firebase.database();
            const blockedRef = db.ref('blocked_classes');
            
            // --- LOGIC ADMIN (K·∫øt n·ªëi th√†nh c√¥ng m·ªõi ch·∫°y) ---
            const classInput = document.getElementById('classInput');
            const tagList = document.getElementById('tagList');
            const loadingText = document.getElementById('loading');

            // Th√™m
            window.addNewClass = function() {
                const val = classInput.value.trim();
                if (val) {
                    blockedRef.push(val);
                    classInput.value = '';
                    classInput.focus();
                }
            };

            // X√≥a
            window.deleteClass = function(key) {
                if(confirm("X√≥a ch·∫∑n class n√†y?")) {
                    blockedRef.child(key).remove();
                }
            };

            // L·∫Øng nghe d·ªØ li·ªáu
            blockedRef.on('value', (snapshot) => {
                loadingText.style.display = 'none';
                tagList.innerHTML = '';
                if (snapshot.exists()) {
                    snapshot.forEach((child) => {
                        createTagElement(child.key, child.val());
                    });
                } else {
                    tagList.innerHTML = '<span style="color:#666">Ch∆∞a c√≥ d·ªØ li·ªáu.</span>';
                }
            });

            function createTagElement(key, text) {
                const div = document.createElement('div');
                div.className = 'tag-chip';
                div.innerHTML = `<span class="tag-name">${text}</span><button class="tag-delete" onclick="deleteClass('${key}')">‚úï</button>`;
                tagList.appendChild(div);
            }
            
            classInput.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') addNewClass();
            });

        } catch (error) {
            console.error("L·ªói Firebase:", error);
            document.getElementById('loading').innerHTML = "‚ùå L·ªói k·∫øt n·ªëi Firebase (Xem Console F12)";
        }

        // --- 2. LOGIC GIAO DI·ªÜN TV (Lu√¥n ch·∫°y d√π Firebase l·ªói hay kh√¥ng) ---
        const myLinks = [
            { name: "B√≥ng ƒê√° (X√¥i l·∫°c)", url: "https://childluresprevention.com", icon: "‚öΩ" },
            { name: "B√≥ng ƒê√° (Th·∫≠p c·∫©m)", url: "https://reneopharma.com/", icon: "‚öΩ" },
            { name: "Phim: Th·∫©m Ph√°n", url: "https://www.moximovie.click/phim/tham-phan-trung-sinh", icon: "‚öñÔ∏è" },
            { name: "Phim: H√≥a Th√¢n", url: "https://www.moximovie.click/phim/hoa-than", icon: "üé≠" },
            { name: "Phim: L·ªùi h·ªìi ƒë√°p", url: "https://www.moximovie.click/phim/loi-hoi-dap-1988", icon: "‚ñ∂Ô∏è" },
            { name: "YouTube", url: "https://www.youtube.com/", icon: "üî¥" }
        ];

        const appContainer = document.getElementById('app');
        const reloadBtn = document.getElementById('reloadBtn');

        myLinks.forEach((item) => {
            const link = document.createElement('a');
            link.href = item.url;
            link.className = 'card';
            link.setAttribute('tabindex', '0'); 
            link.innerHTML = `<div class="card-icon">${item.icon}</div><div class="card-title">${item.name}</div>`;
            link.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') window.location.href = item.url;
            });
            appContainer.appendChild(link);
        });

        reloadBtn.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') location.reload();
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                const first = document.querySelector('.card');
                if (first) first.focus();
            }
        });
        reloadBtn.addEventListener('click', () => location.reload());

        window.onload = function() {
            const first = document.querySelector('.card');
            if (first) first.focus();
        };

        document.addEventListener('keydown', function(e) {
            if (document.activeElement === document.getElementById('classInput')) return;
            const cards = Array.from(document.querySelectorAll('.card'));
            const current = document.activeElement;
            if (current === reloadBtn) return;
            
            const index = cards.indexOf(current);
            if (index === -1) { 
                if(cards.length > 0) cards[0].focus();
                return;
            }

            let next = index;
            const cols = 3;
            if (e.key === 'ArrowRight') next = index + 1;
            else if (e.key === 'ArrowLeft') next = index - 1;
            else if (e.key === 'ArrowDown') next = index + cols;
            else if (e.key === 'ArrowUp') {
                if (index < cols) { e.preventDefault(); reloadBtn.focus(); return; }
                next = index - cols;
            }

            if (next >= 0 && next < cards.length) {
                e.preventDefault();
                cards[next].focus();
            }
        });
    </script>
</body>
</html>
